---
layout:       post
title:        "控制台字符游戏 “射击游戏”"
subtitle:     "shhoter console game program"
date:         2018-05-24 11:12:00
author:       "xuepro"
header-img:   "img/home_bg.jpg"
header-mask:  0.3
catalog:      true
multilingual: true
tags:
    - C++
    
---    

这2天让学生学习我的好友河海大学童晶老师的“做游戏、学C语言”的课程，我自己也顺便看了一下，发现这种讲课模式非常好、非常受学生欢迎。尽管之前，
童老师和我说他一直用做游戏方式教学生学C语言，我一直没在意。 我今天早上用他书中的“射击游戏”为示例写了一个控制台模式下的字符游戏框架，希望小朋友将我这个程序
中的许多对象如画布（canvas）、各种精灵(如射击者shooter、子弹bullet、敌人enemy等)改成C++的类，并用C++的colletion类如vector等管理所有精灵和对象（敌人、子弹），另外还应该添加其他如随机出现敌人、敌机追击你等功能。 
![](https://wx3.sinaimg.cn/mw690/006Lkwkygy1frqwqu0m5cj30e90c63yv.jpg)

想进一步学习C++游戏编程，可以参加我的暑假的6天"C++小白做游戏"线下课程。具体报名请在微博“教小白精通编程”里找。

下面的代码还没来得及解释，先放出来

```cpp
#include <stdio.h>
#include <windows.h>
#include <iostream>
#include <conio.h>
using namespace std;

//=========辅助函数========
//--------光标定位---------
void gotoxy(int x, int y){
    COORD coord = {x, y};
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);
}
//--------隐藏光标---------
void HideCursor(){
 CONSOLE_CURSOR_INFO cursor_info = {1, 0};
 SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &cursor_info);
}

//==========画布==========

const int canvas_width = 50,canvas_height=20;
char canvas[canvas_height][canvas_width];

int  enemy_x = -1,enemy_y = -1;
int shooter_x,shooter_y;
int bullet_x,bullet_y;

#define background_color ' '
#define background_color_vertical '|'
#define background_color_norizonal '='
#define boundary_color '+'

#define enemy_color '@'
#define shooter_color '*'

#define bullet_color '|'

//---------清空画布--------
void clear_canvas(){
     for(int y = 0; y<canvas_height;y++)
		  for(int x = 0; x<canvas_width;x++)
              canvas[y][x] = background_color;
     int right  =canvas_width-1;
     for(int y = 0; y<canvas_height;y++){
        canvas[y][0] = background_color_vertical;
        canvas[y][right] = background_color_vertical;
     }
     int bottom  =canvas_height-1;
     for(int x = 0; x<canvas_width;x++){
        canvas[0][x] = background_color_norizonal;
        canvas[bottom][x] = background_color_norizonal;
     }
}

//------初始化------
void setup(){
     HideCursor();
	 enemy_x = canvas_width/2;
	 enemy_y = 2;

	 shooter_x = canvas_width/2;
	 shooter_y  = canvas_height-2;

	 bullet_x = -1; bullet_y = -1;

     clear_canvas();
}

//--------处理输入--------
void processInput(){
	char input;
	if(kbhit()){
		input = getch();
		if(input==' '){
		  bullet_x = shooter_x;
          bullet_y = shooter_y-1;
		}
		else if(input=='a'||input=='A'){
            if(shooter_x>0) shooter_x--;
		}
		else if(input=='d'||input=='D'){
            if(shooter_x<canvas_width-1)
                shooter_x++;
		}
		else if(input=='w'||input=='W'){
            if(shooter_y>0) shooter_y--;
		}
		else if(input=='s'||input=='S'){
            if(shooter_y<canvas_height-1)
                shooter_y++;
		}
	}

}

//--------更新数据--------
void update(){
  if(bullet_y>1) bullet_y--;
}

//---------绘制场景--------
void renderScene(){
    clear_canvas();

	if(enemy_x>=0&&enemy_x<canvas_width
    &&enemy_y>=0&&enemy_y<canvas_height)
		canvas[enemy_y][enemy_x] =  enemy_color;

    canvas[shooter_y][shooter_x] =  shooter_color;

	if(bullet_x>=0&&bullet_x<canvas_width&&bullet_y>=0
    &&bullet_y<canvas_height)
		canvas[bullet_y][bullet_x] =  bullet_color;
}

//---------显示画面----------
void show(){
    gotoxy(0,0);
	for(int y = 0; y< canvas_height;y++){
		  for(int x = 0; x< canvas_width;x++)
			  std::cout<<canvas[y][x];//printf("%c",canvas[y][x]);//
		  std::cout<<'\n'; // printf("\n");//
	}
	Sleep(5); //睡眠，降低画面刷新速度
}


int main()
{
	setup();

	while(1){
		processInput();
		update();
		renderScene();
	 	show();
	}
  //  gotoxy(10, 3);
  //  cout<<"Hello World!\n";

  return 0;
}


```
