---
layout:       post
title:        C++大作业代码(1)
subtitle:     C++大作业代码(1)
date:         2019-06-05 07:06:00
author:       "xuepro"
header-img:   "img/home_bg.jpg"
header-mask:  0.3
catalog:      true
multilingual: true
tags:
    - DS
---

### 2048游戏

```cpp
//---------------widget.h-----------
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>

#include <QWidget>
#include <QKeyEvent>
#include <QPainter>
#include <QTime>
#include <QPushButton>
#include <QTime>
#include <QtGlobal>
#include <QPushButton>


namespace Ui {
class Widget;
}

class Widget : public QWidget
{
    Q_OBJECT

public:

    explicit Widget(QWidget *parent = nullptr);
    int block[4][4]={0};      //宏定义一个int型数组，储存了方块

    void keyPressEvent(QKeyEvent *event);//输入键盘处理函数

    void move(int direction);//移动函数
    int  score();            //得到分数函数
    void judge();            //判断游戏是否结束函数
    int is_empty();          //判断是不是还有空的方块
    bool is_merge();         //判断相邻两个方块之间是否可以合并

    //定义储存横纵坐标类
    struct point{
        int i;
        int j;
    };
    struct point po[16]={};//用于存放空点的位置坐标
    //定义按钮用于重新开始游戏
    QPushButton *restart_button;
    //图形界面绘制函数
    void paint(QPainter *p,int num,QString color,int i,int j );
    void paintEvent(QPaintEvent *);


    ~Widget();
signals:


private:
    Ui::Widget *ui;
public slots: //定义槽函数，处理按钮点击事件
  void  start();
private slots:

};

#endif // WIDGET_H
```

```cpp
//---------------------widget.cpp----------------------
#include "widget.h"
#include "ui_widget.h"

#include<QMessageBox>
#include<QtGlobal>
#include<cstdio>
#include<QPushButton>
#include<QDebug>
Widget::Widget(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::Widget)
{
    ui->setupUi(this);
    restart_button = new  QPushButton(QStringLiteral("开始游戏"),this);
    restart_button->setGeometry(96,425,200,50);
    this->grabKeyboard();

    connect(restart_button,SIGNAL(clicked()),this,SLOT(start()));

}

Widget::~Widget()
{
    delete ui;
}
void Widget::start(){
     restart_button->setText(QStringLiteral("重新开始"));
    for(int i=0;i<4;i++)
        for (int j=0;j<4;j++) {
            block[i][j]=0;
        }
    int temp1=rand()%3;
    int temp2=rand()%3;
    int num1=temp1==0?2:4;
    int num2=temp2==0?2:4;

    //随机两个坐标
    int x1=rand()%4;
    int x2=rand()%4;
    int y1=rand()%4;
    int y2=rand()%4;
    //防止两个点相同
    while((x1==x2)&&(y1==y2)){
         x2=rand()%4;
         y2=rand()%4;
    }
    block[x1][y1]=num1;
    block[x2][y2]=num2;


    update();


}

//绘制方块函数
void Widget::paint(QPainter *p,int num,QString color,int i,int j){
    p->setBrush(QColor(color));
    p->drawRect(i*72+60,j*72+120,66,66);

    p->setFont(QFont(QString::fromLocal8Bit("华文琥珀"),10,QFont::Normal));
    if(num<64){
    p->setPen(QFont::Black);
    p->drawText(QRectF(i*72+60,j*72+120,66,66),QString::number(num),QTextOption(Qt::AlignCenter));}
    else {
        p->setPen(Qt::white);
        p->drawText(QRectF(i*72+60,j*72+120,66,66),QString::number(num),QTextOption(Qt::AlignCenter));
    }


}
void Widget::paintEvent(QPaintEvent *)
{
    QPainter p(this);
    p.setBrush(QColor("#b8af9e"));
    p.setFont(QFont(QString::fromLocal8Bit("华文琥珀"),12,QFont::Normal));

    QString strscore;
   // p.setFont(QFont::)
    p.drawText(QPoint(10,20),QStringLiteral("用↑,↓,←,→分别控制方块上下左右移动"));
    p.setFont(QFont(QString::fromLocal8Bit("华文琥珀"),20,QFont::Normal));
    p.drawText(QPoint(10,60),QStringLiteral("分数：")+QString::number(score()));

    for(int i=0;i<4;i++)
        for(int j=0;j<4;j++){
            p.setPen(Qt::transparent);
            if(block[i][j] == 0){
                p.setBrush(QColor("#ccc0b2"));
                p.drawRect(i*72+60,j*72+120,66,66);

            }
            else if (block[i][j]==2){
               paint(&p,block[i][j],"#eee4da",i,j);

            }
            else if (block[i][j]==4){
                paint(&p,block[i][j],"#ece0c8",i,j);

            }
            else if (block[i][j]==8){
                paint(&p,block[i][j],"#f2b179",i,j);

            }
            else if (block[i][j]==16) {
                paint(&p,block[i][j],"#f59563",i,j);
            }
            else if (block[i][j]==32) {
                paint(&p,block[i][j],"#f57c5f",i,j);
            }
            else if (block[i][j]==64) {
                paint(&p,block[i][j],"#f65d38",i,j);
            }
            else if (block[i][j]==128) {
                paint(&p,block[i][j],"#edc171",i,j);
            }
            else if (block[i][j]==256) {
                paint(&p,block[i][j],"#edcc61",i,j);
            }
            else if (block[i][j]==512) {
                paint(&p,block[i][j],"#ecc850",i,j);
            }
            else if (block[i][j]==1024) {
                paint(&p,block[i][j],"#edc53f",i,j);
            }
            else if (block[i][j]==2048) {
                paint(&p,block[i][j],"#efc4ef",i,j);
            }

           }
}


//遍历数组获取得分
int Widget::score(){
    int grade=0;
    for(int col=0;col<4;++col)
    {
        for (int row = 0; row < 4; ++row)
        {
            grade+=block[col][row];
        }
    }
   return grade;
}
//根据键盘输入移动所有方块
void Widget::move(int direction){

    switch(direction){

      case 1://向上移动
        for(int i = 1; i < 4; ++i)
                {
                    for(int ci = i; ci >= 1; --ci)
                    {
                        for(int j = 0; j < 4; ++j)
                        {
                            //上一个格子为空
                            if(block[ci-1][j] == 0)
                            {
                                block[ci-1][j] = block[ci][j];
                                block[ci][j] = 0;
                            }
                            else
                            {
                                //合并
                                if(block[ci-1][j] == block[ci][j])
                                {
                                    block[ci - 1][j] *= 2;
                                    block[ci][j] = 0;
                                }

                            }
                        }
                    }
                }


        break;

      case 2 :

         for(int j = 2; j >= 0; --j)
                {
                    for(int cj = j; cj < 3; ++cj)
                    {
                        for(int i = 0; i < 4; ++i)
                        {
                            if(block[cj + 1][i] == 0)
                            {
                                block[cj + 1][i] = block[cj][i];
                                block[cj][i] = 0;
                            }
                            else
                            {

                                if(block[cj + 1][i] == block[cj][i])
                                {
                                    block[cj + 1][i] *= 2;
                                    block[cj][i] = 0;
                                }

                            }
                        }
                    }
                }



           break;
       case 3://向左移动

            for(int  i = 1; i < 4; ++i)
            {
                for(int ci = i; ci >= 1; --ci)
                {
                    for(int j = 0; j < 4; ++j)
                    {
                        //左边格子为空
                        if(block[j][ci-1] == 0)
                        {
                            block[j][ci - 1] = block[j][ci];
                            block[j][ci] = 0;
                        }
                        else
                        {
                            //合并有值相同的项
                            if(block[j][ci - 1] == block[j][ci])
                            {
                                block[j][ci - 1] *= 2;
                                block[j][ci] = 0;
                            }

                        }
                    }
                }
            }

        break;
       case 4:

        for(int  i = 2; i >= 0; --i)
                {
                    for(int ci = i; ci <= 4 - 2; ++ci)
                    {
                        for(int j = 0; j < 4; ++j)
                        {

                            if(block[j][ci + 1] == 0)
                            {
                                block[j][ci + 1] = block[j][ci];
                                block[j][ci] = 0;
                            }
                            else
                            {

                                if(block[j][ci + 1] == block[j][ci])
                                {
                                    block[j][ci + 1] *= 2;
                                    block[j][ci] = 0;
                                }

                            }
                        }
                    }
                }
                break;



   }

}
//处理键盘事件
void Widget::keyPressEvent(QKeyEvent *event)
     {
     //上下左右键控制在制定方向上移动
        switch(event->key())
        {
         case Qt::Key_Up:
              move(3);
              break;
         case Qt::Key_Down:
              move(4);
              break;
         case Qt::Key_Left:
              move(1);
              break;
         case Qt::Key_Right:
              move(2);
              break;
         default:return;//忽略其他按键
        }


        update();
        judge();
}

//判断游戏进程
int Widget::is_empty(){
    int  count=0;
    for(int i=0;i<4;i++)
    {
        for(int j=0;j<4;j++)
        {
            if(block[i][j]==0){
                count+=1;
                //将空的方块坐标放入到储存方块位置的坐标里
                po[count-1].i=i;
                po[count-1].j=j;

            }
        }
    }
    return count;
}
//遍历每一个方块看他周围有没有可以与他合并的额方块
bool Widget::is_merge(){
    for(int i = 0 ; i < 4; ++i)
        {
            for(int j = 0; j < 3; ++j)
            {
                if( block[i][j] == block[i][j+1])
                {
                    return true;

                }
            }
        }

        for(int j = 0; j< 4; ++j)
        {
            for(int i = 0; i < 3; ++i)
            {
                if(block[i][j] == block[i+1][j])
                {
                    return true;

                }
            }


        }
        return false;
}
void Widget::judge(){
    //判断游戏是否胜利
    for(int i=0;i<4;i++)
    {
        for (int j = 0; j < 4; ++j) {
            if(block[i][j]==2048)break;

        }
    }
    //检测所有
    if(is_empty()==0){
        if(!is_merge())
        {
          QMessageBox::about(this,QStringLiteral("游戏失败"),QStringLiteral("您失败了, 当前分数：")+QString::number(score())+"       ");
        }
    }
    else if(is_empty()==1){
        int temp=rand()%3;
        int num=temp==0?2:4;
        block[po[0].i][po[0].j]=num;//将空值随机赋值出2,4
        update();
        if(!is_merge()){
        QMessageBox::about(this,QStringLiteral("游戏失败"),QStringLiteral("您失败了, 当前分数：")+QString::number(score())+"       ");
       }

    }
    else if (is_empty()==2) {
        int temp1=rand()%3;
        int temp2=rand()%3;
        int num1=temp1==0?4:2;
        int num2=temp2==0?4:2;
        block[po[0].i][po[0].j]=num1;
        block[po[1].i][po[1].j]=num2;
        update();
        if(!is_merge()){
        QMessageBox::about(this,QStringLiteral("游戏失败"),QStringLiteral("您失败了,当前分数：")+QString::number(score())+"       ");
       }

    }
    else if (is_empty()>2) {
        int temp1=rand()%3;
        int temp2=rand()%3;
        int num1=temp1==0?4:2;
        int num2=temp2==0?4:2;

        //在多个点中随机两个点
        int m1=rand()%(is_empty());
        int m2=rand()%(is_empty());
        //防止选择的两个点相同
        while(m2==m1){
             m2=rand()%(is_empty());

         }
        block[po[m1].i][po[m1].j]=num1;
        block[po[m2].i][po[m2].j]=num2;
        update();

       }

}
```
```cpp
//-------------------------main.cpp----------------

#include "widget.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    Widget w;
    w.setFixedSize(400,500);
    w.setWindowTitle("2048");
    w.setWindowIcon(QIcon(":/new/prefix1/2048.jpg"));
    w.show();

    return a.exec();
}

```

### 简易租车程序

```cpp
#include <iostream>
#include <string>
#include <vector>
#include <stdio.h>
#include <stdlib.h>
using namespace std;
const int car_num = 5;//个体能租的最大汽车数量

class car {
	int carid;//车辆编号
	string carname;//车型
	double bill;//租金
	int flag{ 0 };//租赁标志
public:
	car() {}
	car(int a, string n, double b, int c) {
		carid = a;
		carname = n;
		bill = b;
		flag = c;
	}
	//车辆未租
	void in() {
		flag = 1;
	}
	//车辆已租
	void out() {
		flag = 0;
	}
	//得到租金
	double getbill() {
		return bill;
	}
	//得到车辆编号
	int getcarid() {
		return carid;
	}
	//设置租金
	void setbill(double b) {
		bill = b;
	}
	//设置车型
	void setcarname(string n) {
		carname = n;
	}
	//打印单个车辆信息
	void print() {
		cout << carid << "\t\t" << carname << "\t\t" << bill << "\t\t" << flag << endl;
	}
};

class client {
	string name;//用户名字
	int client_no;//用户id
	int carno[car_num]{ 0 };//记录租的车辆编号
	double check{ 0 };//总租金
public:
	client() {}
	client(int no, string name) {
		this->client_no = no;
		this->name = name;
	}
	//得到用户id
	int getno() { return client_no; }
	//修改用户名字
	void setname(string s) { name = s; }
	//借车
	void borrow(car a_car) {
		int i;
		for (i = 0; i < car_num; i++)
		{
			if (carno[i] == 0)
			{
				carno[i] = a_car.getcarid();
				check += a_car.getbill();
				break;
			}
		}
		if (i == car_num)
			cout << "该用户已达最大租车数量" << endl;
	}
	//还车
	void back(car a_car) {
		int i;
		for (i = 0; i < car_num; i++)
		{
			if (carno[i] == a_car.getcarid())
			{
				carno[i] = 0;
				check -= a_car.getbill();
				return;
			}
		}
		cout << "该用户未租编号为" << a_car.getcarid() << "的车" << endl;
	}
	//打印单条用户信息
	void print() {
		cout << client_no << "\t\t" << name << "\t\t" << check << "\t\t";
		for (int i = 0; i < car_num; i++)
		{
			if (carno[i] != 0) { cout << carno[i] << '#'; }
		}
		cout << endl;
	}
};

class client_db {
public:
	vector<client> clients;
	client_db() {
		client c1(1001, "张三");
		client c2(1002, "李四");
		client c3(1003, "王五");
		clients.push_back(c1);
		clients.push_back(c2);
		clients.push_back(c3);
	}
	//得到指定编号的用户位置
	int get_cli(int id) {
		for (int i = 0; i < clients.size(); i++)
		{
			if (clients[i].getno() == id)
				return i;
		}
		return -1;
	}
	//增加用户
	void addcli(client cli) {
		clients.push_back(cli);
	}
	//删除
	void delcli(int n) {
		int flag = 0;
		//使用erase删除，防止iter变成野指针
		for (vector<client>::iterator iter = clients.begin(); iter != clients.end(); )
		{
			if (iter->getno() == n)
			{
				iter = clients.erase(iter);
				flag = 1;
			}
			else
				iter++;
		}
		if (flag == 0)
			cout << "查无此户" << endl;
	}
	//打印所有用户
	void print() {
		printf("----------------客户信息----------------\n");
		printf("编号       姓名       租金($)    已租车辆编号\n");
		for (int i = 0; i < clients.size(); i++)
			clients[i].print();
	}
};

class car_db {
public:
	vector<car> cars;
	car_db() {
		car c1(9001, "大众", 200, 1);
		car c2(9002, "宝马", 300, 1);
		car c3(9003, "五菱", 50, 1);
		cars.push_back(c1);
		cars.push_back(c2);
		cars.push_back(c3);
	}
	//查询编号为id的车在vector中位置,返回car类型
	car get_car(int id) {
		int i;
		for (i = 0; i < cars.size(); i++)
		{
			if (cars[i].getcarid() == id)
				break;
		}
		return cars[i];
	}
	//查询编号为id的车在vector中位置,返回下标
	int get_car_no(int id) {
		int i;
		for (i = 0; i < cars.size(); i++)
		{
			if (cars[i].getcarid() == id)
				break;
		}
		return i;
	}
	//增加汽车信息
	void addcar(car c) {
		cars.push_back(c);
	}
	//删除汽车信息
	void delcar(int car_id) {
		int flag = 0;
		//使用erase删除，防止iter变成野指针
		for (vector<car>::iterator iter = cars.begin(); iter != cars.end(); )
		{
			if (iter->getcarid() == car_id)
			{
				iter = cars.erase(iter);
				flag = 1;
			}
			else
				iter++;
		}
		if (flag == 0)
			cout << "查无此车" << endl;
	}
	//打印所有汽车信息
	void print() {
		printf("----------------车辆信息----------------\n");
		printf("编号       车型       租金       出租情况\n");
		for (int i = 0; i < cars.size(); i++)
			cars[i].print();
	}
};

//全局变量:客户db、汽车db
client_db clidb;
car_db cardb;

//交互操作函数
void add_client() {//增加用户
	int num;
	string name;
	cout << "请输入编号:";
	cin >> num;
	cout << "请输入姓名:";
	cin >> name;
	client c(num, name);
	clidb.addcli(c);
}
void del_client() {//删除用户
	int num;
	cout << "请输入要删除的用户编号:";
	cin >> num;
	clidb.delcli(num);
}
void add_car() {//增加汽车
	int num;
	double rent;
	char name[2];
	cout << "请输入编号:";
	cin >> num;
	cout << "请输入车型:";
	cin >> name;
	cout << "请输入租金:";
	cin >> rent;
	car c(num, name, rent, 1);
	cardb.addcar(c);
}
void del_car() {//删除汽车
	int num;
	cout << "请输入要删除的车辆编号:";
	cin >> num;
	cardb.delcar(num);
}
void borrow_car() {//借车
	int cliid, carid, cliindex, carindex;
	car car_;
	cout << "请输入要借车的用户编号：";
	cin >> cliid;
	cout << "请输入要租的车的编号：";
	cin >> carid;
	cliindex = clidb.get_cli(cliid);
	car_ = cardb.get_car(carid);
	clidb.clients[cliindex].borrow(car_);
	carindex = cardb.get_car_no(carid);
	cardb.cars[carindex].out();
}
void back_car() {//还车
	int cliid, carid, cliindex, carindex;
	car car_;
	cout << "请输入要还车的用户编号：";
	cin >> cliid;
	cout << "请输入要还的车的编号：";
	cin >> carid;
	cliindex = clidb.get_cli(cliid);
	car_ = cardb.get_car(carid);
	clidb.clients[cliindex].back(car_);
	carindex = cardb.get_car_no(carid);
	cardb.cars[carindex].in();
}
void update_client() {
	int num, pos;
	string n;
	cout << "请输入要修改的用户编号:";
	cin >> num;
	cout << "请输入新的姓名:";
	cin >> n;
	pos = clidb.get_cli(num);
	clidb.clients[pos].setname(n);
	cout << "修改完成！" << endl;
}
void update_car() {
	int num, pos;
	double b;
	string n;
	cout << "请输入要修改的车辆编号:";
	cin >> num;
	cout << "请输入新的车型:";
	cin >> n;
	cout << "请输入租金:";
	cin >> b;
	pos = cardb.get_car_no(num);
	cardb.cars[pos].setcarname(n);
	cardb.cars[pos].setbill(b);
	cout << "修改完成！" << endl;
}
void new_main() {
	char fu;//用户输入
	while (true)
	{
		printf("-----------------欢迎-----------------\n");
		printf("a--查看用户                  b--查看车辆\n");
		printf("c--增加用户                  d--增加车辆\n");
		printf("e--删除用户                  f--删除车辆\n");
		printf("g--修改用户                  h--修改车辆\n");
		printf("i--用户借车                  j--用户还车\n");
		printf("0--退出                               \n");
		printf("-----------------欢迎-----------------\n");
		cin >> fu;
		if (fu == '0')  return;
		if (fu == 'a')  clidb.print();
		if (fu == 'b')  cardb.print();
		if (fu == 'c')  add_client();
		if (fu == 'd')  add_car();
		if (fu == 'e')  del_client();
		if (fu == 'f')  del_car();
		if (fu == 'g')  update_client();
		if (fu == 'h')  update_car();
		if (fu == 'i')  borrow_car();
		if (fu == 'j')  back_car();
		getchar();
		cout << "按回车继续" << endl;
		getchar();
	}
}

int main() {
	new_main();
	system("pause");
}
```
